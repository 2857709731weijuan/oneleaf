<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/page7.css">
</head>
<body>
    <div class="headerbox">
        <!-- header -->
        <header>
            <div class="hleft">
                <a href="#"> <img src="img/icon_wb.png" alt="" class="wb"></a>
                <a href="#"> <img src="img/icon_wx.png" alt="" class="wx">
                    <img src="img/wx2img.jpg" alt="" class="wximg">
                </a>
            </div>
            <div class="hmiddle">
                <a href="index.html"><img src="img/logo.png" alt=""></a>
            </div>
            <div class="hright">
                <a href="#"> 联系我们</a>
            </div>
            <div id="welcomeBox">
                欢迎您：<span>熊小兜</span> <input id="btnLogout" type="button" value="注销" />
            </div>
            <div id="loginBox">
                <a href="page3.html"> 注册登录</a>
            </div>
            <div class="cartBox">
                <a href="shopping.html"><img src="img/cart_bag.png" alt="" class="cart"> </a> 
            </div>
        </header>
        <!-- nav -->
        <nav id="navv">
            <div class="navbox">
                <a href="mianmo.html">面膜</a>
                <img src="img/icon_round.png" alt="">
                <a href="page1.html">护肤</a>
                <img src="img/icon_round.png" alt="">
                <a href="page2.html" class="pin lis ">专属产品</a>
                <img src="img/icon_round.png" alt="">
                <a href="page6.html" class="lis">品牌专卖店</a>
                <img src="img/icon_round.png" alt="">
                <a href="page5.html">新品试用</a>
            </div>
            <form class="navbar-form navbar-left" role="search">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="搜素...">
                </div>
                <button type="submit" class="btn btn-default">搜素</button>
            </form>
            <div id="small">
                <div class="pinbox boxmegg" id="C">
                    <a href="page2.html">专属产品</a>
                    <a href="#">明星产品</a>
                </div>
                <div class="dianbox boxmegg" id="E">
                    <a href="#">品牌故事</a>
                    <a href="#">品牌资讯</a>
                    <a href="#">当季促销</a>
                    <a href="#">会员专区</a>
                    <a href="#">门店信息</a>
                    <a href="#">加盟政策</a>
                    <a href="#">财富分享</a>
                </div>
            </div>
        </nav>
    </div>
<!-- content -->
   
    <div class="content" id="Goods">
        <!-- <div class="GOODS">
        <div class="imageBox">
            <img src="imgs/showImg 2.jpg" alt="">
        </div>
        <div class="rightBox">
            <p class="eng">Jojoba Moisturizing essential Cream</p>
            <p class="yi">一叶子霍霍巴倍润滋养精华霜</p> 
            <dl>
                <dt>规格</dt>
                <dd>120g</dd>
            </dl>
            <dl>
                <dt>功效</dt>
                <dd>Purifying & Soothing<br>洁净 温和</dd>
            </dl>
           
            <div class="bincl">
                <p >水、甘油、柠檬酸、橄榄油 PEG-7 酯类、小苍兰（FREESIA REFRACTA）提取物等等。</p>
            </div>
            <div class="Cart">
                加入购物车
            </div>
        </div>
    </div> -->
</div> 
        
<!-- footer -->
   <div class="footer">
        <hr>
        上海上美化妆品有限公司 <a href="#">沪ICP备12043696号-5</a> <br>
        中国·上海市中山北路3300号环球港B座22层 TEL：021-52035555
    </div>
</body>
</html>
<script src="js/cookieTools.js"></script>
<script>
var lis = document.getElementsByClassName("lis");
    var divs = document.getElementsByClassName("boxmegg");
    var divd = document.getElementById("navv");
    var div = document.getElementById("small");
    var lll = div.children;
    for (var i = 0; i < lis.length; i++) {
        lis[i].num = i;
        lis[i].onmouseover = function () {
            for (var j = 0; j < divs.length; j++) {
                divs[j].style.display = "none";
            }
            divs[this.num].style.display = "block";
        }
        divd.onmouseleave = function () {
            for (var s = 0; s < lll.length; s++) {
                lll[s].style.display = "none";
            }
        }
    }
    function showUser(){
    let username = getCookie("username");
    if(username!=null){
        $("#welcomeBox").firstElementChild.innerHTML =username;
        $("#welcomeBox").style.display ="block";
        $("#loginBox").style.display = "none";
    }else{
        $("#welcomeBox").style.display ="none";
        $("#loginBox").style.display ="block";
    }
}

    window.onload= function(){
        showUser();
    $("#btnLogout").onclick =function(){
        removeCookie("username");
        showUser();
    }
        let req = new XMLHttpRequest();
		req.open("get","getGoodsInfo.php?goodsId="+"0001",true);
		req.onreadystatechange = function(){
			if(req.readyState==4 && req.status==200){
				let str = req.responseText;
				let objs = JSON.parse(str);
				let htmlStr ="";
					htmlStr =`<div class="GOODS">
                            <div class="imageBox">
                                <img src="${objs.goodsImg}" alt="">
                            </div>
                            <div class="rightBox">
                                <p class="eng">${objs.goodsType}</p>
                                <p class="yi">${objs.goodsName}</p> 
                                <dl>
                                    <dt>规格</dt>
                                    <dd>${objs.beiyong2}</dd>
                                </dl>
                                <dl>
                                    <dt>功效</dt>
                                    <dd>${objs.beiyong3}<br>${objs.beiyong4}</dd>
                                </dl>
                            
                                <div class="bincl">
                                    <p >${objs.beiyong5}</p>
                                </div>
                                <div class="Cart" onclick="goShopping()">
                                    加入购物车
                                </div>
                            </div>;
                        </div>`;
				$("#Goods").innerHTML =htmlStr;
			}
		}
		req.send();
    }

  function goShopping(){
        let xhr = new XMLHttpRequest();
    
    xhr.open("post","addShoppingCart.php",true);

    xhr.onreadystatechange = function(){
        if(xhr.readyState==4 && xhr.status==200){
            if(xhr.responseText=="1"){
                alert("你已经加入！")
            }else{
               alert("加入失败！")
            }
        }
    }
    //post方式：设置请求头
    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    //post方式：把传给服务器端数据（键值对）放在send函数的参数里。
    let name= getCookie("username");
    let sendstr = `vipName=${name}&goodsId=${"goodsId"}&goodsCount=${"1"}`;
    xhr.send(sendstr);
}
function getCookie(key){
		var cookiestr = document.cookie;
		var list = cookiestr.split(";");
		for(var i in list){
			var arr = list[i].split("=");
			if(trim(arr[0]) == key){
				return arr[1];
			}
		}
		return null;
	}
    function trim(str){
		return str.replace(/\s+/g,"");
	}

    function $(str){
	if(str.charAt(0)=="#"){
		return document.getElementById(str.substring(1));
	}else if(str.charAt(0)=="."){
		return document.getElementsByClassName(str.substring(1));
	}else{
		return document.getElementsByTagName(str);
	}
}	
</script>
